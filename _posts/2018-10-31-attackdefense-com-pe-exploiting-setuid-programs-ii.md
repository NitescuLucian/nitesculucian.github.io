---
layout: post
title: AttackDefense.com [PE] - Exploiting Setuid Programs II
date: 2018-10-31 22:10 -0300
categories: [AttackDefense.com, ctf, writeups, PrivilegeEscalation]
tags: [ writeups, CTF,  challange, AttackDefense.com]
---

![Image of AttackDefense 2018](/uploads/Screenshot from 2018-10-26 17-44-27.png)

As you've seen in another challenge in this category, setuid programs can provide great power and flexibility, but if not secured properly, can easily lead to a full system compromise. 

Your mission is to get a root shell on the box!

Level difficulty: Easy

Category: Privilege Escalation > Linux

### Solution

On this challenge, I got the web interface of a Linux terminal and I was authenticated as an unprivileged user named ```student```.

![Image of AttackDefense 2018](/uploads/adpe3/image1.png)

Because my task is about “Exploiting Setuid Programs” of course I started searching for getuid and setuid programs.

![Image of AttackDefense 2018](/uploads/adpe3/image8.png)

And one pops straight to my face as a permission misconfiguration:

![Image of AttackDefense 2018](/uploads/adpe3/image10.png)

Abusing ```vim.tiny``` setuid permission to edit restricted file:

![Image of AttackDefense 2018](/uploads/adpe3/image4.png)

![Image of AttackDefense 2018](/uploads/adpe3/image3.png)

![Image of AttackDefense 2018](/uploads/adpe3/image2.png)

Now that we know the setuid attacks works create a password hash.

```terminal
student@attackdefense:~$ openssl passwd -1 -salt root pass123
$1$root$quimBCDAqK3JX3mbeqrrD1
student@attackdefense:~$
```

Proceed with editing the ```/etc/shadow/``` file and replace the root password hash with the newly generated one.

![Image of AttackDefense 2018](/uploads/adpe3/image7.png)

![Image of AttackDefense 2018](/uploads/adpe3/image5.png)

Authenticate to the root user account:

![Image of AttackDefense 2018](/uploads/adpe3/image9.png)

![Image of AttackDefense 2018](/uploads/adpe3/image6.png)
